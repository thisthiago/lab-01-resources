{"paragraphs":[{"user":"anonymous","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744660739358_262471199","id":"paragraph_1744660739358_262471199","dateCreated":"2025-04-14T19:58:59+0000","status":"FINISHED","focus":true,"text":"%md\r\n# O que é e para que serve o Shuffle no Spark\r\n\r\nO shuffle é uma operação fundamental (e custosa) no Spark que redistribui dados entre as partições para reorganizá-los de acordo com uma nova necessidade. É como um \"reagrupamento\" dos dados.\r\n\r\n### Como funciona:\r\n- Os dados são divididos, transferidos entre nós\r\n- Depois reagrupados em novas partições\r\n- Operação custosa em termos de desempenho\r\n\r\n### Imagine uma sala de aula onde:\r\n1. Todos os alunos se levantam (dados são lidos)\r\n2. Se reorganizam por ordem alfabética (shuffle)\r\n3. Sentam-se em novas carteiras (novas partições)\r\n","dateUpdated":"2025-04-14T20:00:35+0000","dateFinished":"2025-04-14T20:00:35+0000","dateStarted":"2025-04-14T20:00:35+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>O que é e para que serve o Shuffle no Spark</h1>\n<p>O shuffle é uma operação fundamental (e custosa) no Spark que redistribui dados entre as partições para reorganizá-los de acordo com uma nova necessidade. É como um &ldquo;reagrupamento&rdquo; dos dados.</p>\n<h3>Como funciona:</h3>\n<ul>\n<li>Os dados são divididos, transferidos entre nós</li>\n<li>Depois reagrupados em novas partições</li>\n<li>Operação custosa em termos de desempenho</li>\n</ul>\n<h3>Imagine uma sala de aula onde:</h3>\n<ol>\n<li>Todos os alunos se levantam (dados são lidos)</li>\n<li>Se reorganizam por ordem alfabética (shuffle)</li>\n<li>Sentam-se em novas carteiras (novas partições)</li>\n</ol>\n\n</div>"}]}},{"text":"%pyspark\npalavras = [\"maçã\", \"banana\", \"maçã\", \"laranja\"]\nrdd = sc.parallelize(palavras)\ncontagem = rdd.map(lambda x: (x, 1)).reduceByKey(lambda a, b: a + b)\n\nprint(\"Contagem de palavras:\")\nfor (palavra, count) in contagem.collect():\n    print(f\"{palavra}: {count}\")","user":"anonymous","dateUpdated":"2025-04-14T20:04:17+0000","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=29"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=29"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=29"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744660835413_706296653","id":"paragraph_1744660835413_706296653","dateCreated":"2025-04-14T20:00:35+0000","status":"FINISHED","dateFinished":"2025-04-14T20:04:12+0000","dateStarted":"2025-04-14T20:04:08+0000","title":"Agrupar dados por chave","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Contagem de palavras:\nmaçã: 2\nbanana: 1\nlaranja: 1\n"}]},"focus":false},{"text":"%pyspark\nrdd1 = sc.parallelize([(1, \"A\"), (2, \"B\")])\nrdd2 = sc.parallelize([(1, \"X\"), (2, \"Y\")])\nresultado = rdd1.join(rdd2)\n\nprint(\"\\nResultado do join:\")\nresultado.collect()","user":"anonymous","dateUpdated":"2025-04-14T20:04:59+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"title":true,"results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=30"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=30"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=30"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744660870078_2095071129","id":"paragraph_1744660870078_2095071129","dateCreated":"2025-04-14T20:01:10+0000","status":"FINISHED","focus":false,"dateFinished":"2025-04-14T20:04:30+0000","dateStarted":"2025-04-14T20:04:24+0000","title":"Juntar datasets","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nResultado do join:\n[(1, ('A', 'X')), (2, ('B', 'Y'))]\n"}]}},{"text":"%pyspark\nrdd = sc.parallelize([(3, \"C\"), (1, \"A\"), (2, \"B\")])\nrdd_ordenado = rdd.sortByKey()\n\nprint(\"\\nDados ordenados:\")\nrdd_ordenado.collect()","user":"anonymous","dateUpdated":"2025-04-14T20:05:47+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"title":true,"results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=31"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=31"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=31"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=32"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=32"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=32"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=33"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=33"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=33"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744660940459_867960927","id":"paragraph_1744660940459_867960927","dateCreated":"2025-04-14T20:02:20+0000","status":"FINISHED","focus":false,"dateFinished":"2025-04-14T20:05:52+0000","dateStarted":"2025-04-14T20:05:47+0000","title":"Ordenar dados","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nDados ordenados:\n[(1, 'A'), (2, 'B'), (3, 'C')]\n"}]}},{"text":"%pyspark\nrdd = sc.parallelize(range(1000), 10)\nrdd_balanceado = rdd.repartition(20)\n\nprint(f\"\\nPartições antes: {rdd.getNumPartitions()}\")\nprint(f\"Partições depois: {rdd_balanceado.getNumPartitions()}\")\nprint(f\"Primeiros 5 itens: {rdd_balanceado.take(5)}\")","user":"anonymous","dateUpdated":"2025-04-14T20:11:41+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"title":true,"results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=46"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=46"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=46"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744660946580_1755409583","id":"paragraph_1744660946580_1755409583","dateCreated":"2025-04-14T20:02:26+0000","status":"FINISHED","focus":false,"dateFinished":"2025-04-14T20:11:44+0000","dateStarted":"2025-04-14T20:11:41+0000","title":"Reparticionar dados","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nPartições antes: 10\nPartições depois: 20\nPrimeiros 5 itens: [460, 461, 462, 463, 464]\n"}]}},{"text":"%md\n# Repartition vs Coalesce\n\n## *repartition(numPartitions)*\n\nRedistribui os dados em um novo número de partições\n\nUsada para:\n- Para aumentar o número de partições\n- Para balancear dados desigualmente distribuídos\n- Quando você quer uma distribuição mais uniforme\n\n## *coalesce(numPartitions)*\nReduz o número de partições sem shuffle completo\n\nEnvolve shuffle: Só em alguns casos especiais\n\nUsado para:\n- Para diminuir o número de partições\n- Quando você quer evitar o custo do shuffle\n- Após filtros que reduziram muito seus dados\n\n\n\n","user":"anonymous","dateUpdated":"2025-04-14T20:12:10+0000","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744660852766_1696734949","id":"paragraph_1744660852766_1696734949","dateCreated":"2025-04-14T20:00:52+0000","status":"FINISHED","focus":true,"dateFinished":"2025-04-14T20:12:10+0000","dateStarted":"2025-04-14T20:12:10+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Repartition vs Coalesce</h1>\n<h2><em>repartition(numPartitions)</em></h2>\n<p>Redistribui os dados em um novo número de partições</p>\n<p>Usada para:</p>\n<ul>\n<li>Para aumentar o número de partições</li>\n<li>Para balancear dados desigualmente distribuídos</li>\n<li>Quando você quer uma distribuição mais uniforme</li>\n</ul>\n<h2><em>coalesce(numPartitions)</em></h2>\n<p>Reduz o número de partições sem shuffle completo</p>\n<p>Envolve shuffle: Só em alguns casos especiais</p>\n<p>Usado para:</p>\n<ul>\n<li>Para diminuir o número de partições</li>\n<li>Quando você quer evitar o custo do shuffle</li>\n<li>Após filtros que reduziram muito seus dados</li>\n</ul>\n\n</div>"}]}},{"text":"%md\n| Operação    | Shuffle | Custo | Efeito nos Dados               |\n|-------------|---------|-------|--------------------------------|\n| `coalesce`  | Não*    | Baixo | Só reduz partições             |\n| `repartition` | Sim    | Alto  | Pode aumentar ou reduzir partições |","user":"anonymous","dateUpdated":"2025-04-14T20:14:07+0000","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744661398061_520786142","id":"paragraph_1744661398061_520786142","dateCreated":"2025-04-14T20:09:58+0000","status":"FINISHED","focus":true,"dateFinished":"2025-04-14T20:14:07+0000","dateStarted":"2025-04-14T20:14:07+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<table>\n<thead>\n<tr><th>Operação</th><th>Shuffle</th><th>Custo</th><th>Efeito nos Dados</th></tr>\n</thead>\n<tbody>\n<tr><td><code>coalesce</code></td><td>Não*</td><td>Baixo</td><td>Só reduz partições</td></tr>\n<tr><td><code>repartition</code></td><td>Sim</td><td>Alto</td><td>Pode aumentar ou reduzir partições</td></tr>\n</tbody>\n</table>\n\n</div>"}]}},{"text":"%pyspark\n# Reduzindo para 1 partição (sem shuffle completo)\nrdd = sc.parallelize(range(1000), 10)\nrdd_balanceado = rdd.coalesce(1)\n\nprint(f\"\\nPartições antes: {rdd.getNumPartitions()}\")\nprint(f\"Partições depois: {rdd_balanceado.getNumPartitions()}\")\nprint(f\"Primeiros 5 itens: {rdd_balanceado.take(5)}\")","user":"anonymous","dateUpdated":"2025-04-14T20:12:16+0000","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=48"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=48"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=48"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744661314660_550685399","id":"paragraph_1744661314660_550685399","dateCreated":"2025-04-14T20:08:34+0000","status":"FINISHED","focus":false,"dateFinished":"2025-04-14T20:12:17+0000","dateStarted":"2025-04-14T20:12:12+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nPartições antes: 10\nPartições depois: 1\nPrimeiros 5 itens: [0, 1, 2, 3, 4]\n"}]}},{"text":"%md\n","user":"anonymous","dateUpdated":"2025-04-14T20:14:07+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false}},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744661647167_2028659006","id":"paragraph_1744661647167_2028659006","dateCreated":"2025-04-14T20:14:07+0000","status":"READY"}],"name":"Shuffle, Repartition e Coalesce","id":"2KSAW8BXQ","defaultInterpreterGroup":"spark","version":"0.12.0","noteParams":{},"noteForms":{},"angularObjects":{},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{},"path":"/Shuffle, Repartition e Coalesce"}