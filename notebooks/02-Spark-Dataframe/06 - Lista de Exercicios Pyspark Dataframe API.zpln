{"paragraphs":[{"text":"%md\r\n# 📝 Lista de Exercícios - PySpark com o DataFrame AI Generated Ghibli Style Image Trends (2025)\r\n\r\nhttps://www.kaggle.com/datasets/uom190346a/ai-generated-ghibli-style-image-trends-2025\r\n\r\nNeste exercício, você vai praticar operações básicas e intermediárias no PySpark usando um DataFrame que une dados de usuários e imagens geradas por IA.\r\n\r\n---\r\n\r\n#### 📁 1. Leitura de Arquivo\r\n🔹 Leia o arquivo JSON que contém os dados combinados de no minio.\r\n\r\n```python\r\ndf = spark.read.json(\"...\")\r\n","user":"anonymous","dateUpdated":"2025-04-15T16:08:08+0000","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>📝 Lista de Exercícios - PySpark com o DataFrame AI Generated Ghibli Style Image Trends (2025)</h1>\n<p><a href=\"https://www.kaggle.com/datasets/uom190346a/ai-generated-ghibli-style-image-trends-2025\">https://www.kaggle.com/datasets/uom190346a/ai-generated-ghibli-style-image-trends-2025</a></p>\n<p>Neste exercício, você vai praticar operações básicas e intermediárias no PySpark usando um DataFrame que une dados de usuários e imagens geradas por IA.</p>\n<hr />\n<h4>📁 1. Leitura de Arquivo</h4>\n<p>🔹 Leia o arquivo JSON que contém os dados combinados de no minio.</p>\n<pre><code class=\"language-python\">df = spark.read.json(&quot;...&quot;)\n</code></pre>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744733185639_882926082","id":"paragraph_1744733185639_882926082","dateCreated":"2025-04-15T16:06:25+0000","dateStarted":"2025-04-15T16:08:08+0000","dateFinished":"2025-04-15T16:08:08+0000","status":"FINISHED","focus":true},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2025-04-15T16:14:11+0000","progress":0,"config":{"tableHide":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744733642285_1295775942","id":"paragraph_1744733642285_1295775942","dateCreated":"2025-04-15T16:14:02+0000","status":"READY"},{"text":"%md\n#### 🔍 2. Seleção de Colunas\n🔹 Selecione apenas as colunas:\n\n`user_id`\n`platform`\n`likes`\n`prompt`\n\n🔹 E exiba as 10 primeiras linhas.\n","user":"anonymous","dateUpdated":"2025-04-15T16:13:56+0000","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h4>🔍 2. Seleção de Colunas</h4>\n<p>🔹 Selecione apenas as colunas:</p>\n<p><code>user_id</code><br />\n<code>platform</code><br />\n<code>likes</code><br />\n<code>prompt</code></p>\n<p>🔹 E exiba as 10 primeiras linhas.</p>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744733236034_1147653727","id":"paragraph_1744733236034_1147653727","dateCreated":"2025-04-15T16:07:16+0000","dateStarted":"2025-04-15T16:13:56+0000","dateFinished":"2025-04-15T16:13:56+0000","status":"FINISHED"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2025-04-15T16:14:14+0000","progress":0,"config":{"tableHide":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744733651446_944716422","id":"paragraph_1744733651446_944716422","dateCreated":"2025-04-15T16:14:11+0000","status":"READY"},{"text":"%md\n#### 🔄 3. Conversão de Colunas\n🔹 Converta a coluna likes para o tipo DoubleType.","user":"anonymous","dateUpdated":"2025-04-15T16:14:00+0000","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h4>🔄 3. Conversão de Colunas</h4>\n<p>🔹 Converta a coluna likes para o tipo DoubleType.</p>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744733293858_1722473296","id":"paragraph_1744733293858_1722473296","dateCreated":"2025-04-15T16:08:13+0000","dateStarted":"2025-04-15T16:14:00+0000","dateFinished":"2025-04-15T16:14:00+0000","status":"FINISHED"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2025-04-15T16:17:09+0000","progress":0,"config":{"tableHide":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744733823939_896300782","id":"paragraph_1744733823939_896300782","dateCreated":"2025-04-15T16:17:03+0000","status":"READY"},{"text":"%md\n#### 🎯 4. Filtro de Dados\n🔹 Filtre o DataFrame para mostrar apenas:\n\n- Imagens com mais de 1000 curtidas\n- E que foram publicadas na plataforma TikTok","user":"anonymous","dateUpdated":"2025-04-15T16:14:34+0000","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h4>🎯 4. Filtro de Dados</h4>\n<p>🔹 Filtre o DataFrame para mostrar apenas:</p>\n<ul>\n<li>Imagens com mais de 1000 curtidas</li>\n<li>E que foram publicadas na plataforma TikTok</li>\n</ul>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744733631508_1641498737","id":"paragraph_1744733631508_1641498737","dateCreated":"2025-04-15T16:13:51+0000","dateStarted":"2025-04-15T16:14:34+0000","dateFinished":"2025-04-15T16:14:34+0000","status":"FINISHED"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2025-04-15T16:17:12+0000","progress":0,"config":{"tableHide":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744733829247_334804799","id":"paragraph_1744733829247_334804799","dateCreated":"2025-04-15T16:17:09+0000","status":"READY"},{"text":"%md\n#### 📊 5. Operações de Agregação\n🔹 Calcule:\n\n- A média de curtidas por plataforma\n- O número total de imagens por valor de is_hand_edited","user":"anonymous","dateUpdated":"2025-04-15T16:14:53+0000","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h4>📊 5. Operações de Agregação</h4>\n<p>🔹 Calcule:</p>\n<ul>\n<li>A média de curtidas por plataforma</li>\n<li>O número total de imagens por valor de is_hand_edited</li>\n</ul>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744733666077_2046435262","id":"paragraph_1744733666077_2046435262","dateCreated":"2025-04-15T16:14:26+0000","dateStarted":"2025-04-15T16:14:53+0000","dateFinished":"2025-04-15T16:14:53+0000","status":"FINISHED"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2025-04-15T16:17:15+0000","progress":0,"config":{"tableHide":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744733832265_1356070722","id":"paragraph_1744733832265_1356070722","dateCreated":"2025-04-15T16:17:12+0000","status":"READY"},{"text":"%md\n#### 🔢 6. Ordenamento de Dados\n🔹 Mostre os 5 prompts mais curtidos, ordenando pela coluna likes em ordem decrescente.","user":"anonymous","dateUpdated":"2025-04-15T16:15:05+0000","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h4>🔢 6. Ordenamento de Dados</h4>\n<p>🔹 Mostre os 5 prompts mais curtidos, ordenando pela coluna likes em ordem decrescente.</p>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744733693298_673471593","id":"paragraph_1744733693298_673471593","dateCreated":"2025-04-15T16:14:53+0000","dateStarted":"2025-04-15T16:15:05+0000","dateFinished":"2025-04-15T16:15:05+0000","status":"FINISHED"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2025-04-15T16:17:18+0000","progress":0,"config":{"tableHide":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744733835680_249225256","id":"paragraph_1744733835680_249225256","dateCreated":"2025-04-15T16:17:15+0000","status":"READY"},{"text":"%md\n#### ♻️ 7. Deduplicação\n🔹 Remova registros duplicados (se existirem) com base na combinação de user_id e prompt.","user":"anonymous","dateUpdated":"2025-04-15T16:15:19+0000","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h4>♻️ 7. Deduplicação</h4>\n<p>🔹 Remova registros duplicados (se existirem) com base na combinação de user_id e prompt.</p>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744733705848_1696369737","id":"paragraph_1744733705848_1696369737","dateCreated":"2025-04-15T16:15:05+0000","dateStarted":"2025-04-15T16:15:19+0000","dateFinished":"2025-04-15T16:15:19+0000","status":"FINISHED"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2025-04-15T16:17:21+0000","progress":0,"config":{"tableHide":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744733838711_1672976924","id":"paragraph_1744733838711_1672976924","dateCreated":"2025-04-15T16:17:18+0000","status":"READY"},{"text":"%md\n#### 💾 8. Escrita no Formato CSV\n🔹 Salve o DataFrame final (após todas as transformações) no formato CSV com:\n\n- Cabeçalho\n- Separador ;","user":"anonymous","dateUpdated":"2025-04-15T16:15:50+0000","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h4>💾 8. Escrita no Formato CSV</h4>\n<p>🔹 Salve o DataFrame final (após todas as transformações) no formato CSV com:</p>\n<ul>\n<li>Cabeçalho</li>\n<li>Separador ;</li>\n</ul>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744733719007_1455525504","id":"paragraph_1744733719007_1455525504","dateCreated":"2025-04-15T16:15:19+0000","dateStarted":"2025-04-15T16:15:50+0000","dateFinished":"2025-04-15T16:15:50+0000","status":"FINISHED"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2025-04-15T16:17:25+0000","progress":0,"config":{"tableHide":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744733841811_365395585","id":"paragraph_1744733841811_365395585","dateCreated":"2025-04-15T16:17:21+0000","status":"READY"},{"text":"%md\n#### Extra (Desafio)\n🔹 Crie uma nova coluna chamada engajamento_total que representa:\n```\nlikes + shares + comments\n```\n\nE ordene os resultados do maior para o menor valor de engajamento_total.","user":"anonymous","dateUpdated":"2025-04-15T16:16:44+0000","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h4>Extra (Desafio)</h4>\n<p>🔹 Crie uma nova coluna chamada engajamento_total que representa:</p>\n<pre><code>likes + shares + comments\n</code></pre>\n<p>E ordene os resultados do maior para o menor valor de engajamento_total.</p>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744733750079_820488244","id":"paragraph_1744733750079_820488244","dateCreated":"2025-04-15T16:15:50+0000","dateStarted":"2025-04-15T16:16:44+0000","dateFinished":"2025-04-15T16:16:44+0000","status":"FINISHED"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2025-04-15T16:17:27+0000","progress":0,"config":{"tableHide":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744733772307_249781370","id":"paragraph_1744733772307_249781370","dateCreated":"2025-04-15T16:16:12+0000","status":"READY"}],"name":"06 - Lista de Exercicios Pyspark Dataframe API","id":"2KT81JTXJ","defaultInterpreterGroup":"spark","version":"0.12.0","noteParams":{},"noteForms":{},"angularObjects":{},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{},"path":"/06 - Lista de Exercicios Pyspark Dataframe API"}