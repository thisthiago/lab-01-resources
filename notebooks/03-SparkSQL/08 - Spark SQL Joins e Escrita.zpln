{"paragraphs":[{"text":"%md\r\n# Spark Sql Joins e Escrita \r\n\r\n> https://www.kaggle.com/datasets/kannan1314/innocent-deaths-caused-by-police-all-time/data\r\n\r\n##  Análise de Dados sobre Mortes Causadas por Polícia nos EUA\r\n\r\n#### Sobre o conjunto de dados\r\n\r\nEste conjunto de dados documenta mortes de civis causadas por intervenção policial nos Estados Unidos. Os registros abrangem diversos casos com informações detalhadas sobre vítimas, circunstâncias dos incidentes, localizações e agências envolvidas.\r\n\r\n#### Entidades:\r\n1. `victims.csv` - Informações sobre as vítimas\r\n2. `incidents.csv` - Detalhes dos incidentes\r\n3. `locations.csv` - Dados geográficos\r\n4. `agencies.csv` - Agências policiais envolvidas\r\n\r\n## Dicionário de Dados\r\n\r\n### Tabela: `victims`\r\n\r\n| Coluna | Tipo | Descrição |\r\n|--------|------|-----------|\r\n| unique_id | INT | Identificador único da vítima (PK) |\r\n| name | STRING | Nome completo da vítima |\r\n| age | INT | Idade da vítima |\r\n| gender | STRING | Gênero (Male/Female) |\r\n| race | STRING | Raça/etnia (African-American, White, Hispanic, etc.) |\r\n| image_url | STRING | URL com foto da vítima |\r\n\r\n### Tabela: `incidents`\r\n\r\n| Coluna | Tipo | Descrição |\r\n|--------|------|-----------|\r\n| unique_id | INT | Chave estrangeira para vítima (FK) |\r\n| incident_date | STRING | Data do incidente (MM/DD/YYYY) |\r\n| highest_level_of_force | STRING | Nível máximo de força utilizado |\r\n| alleged_weapon | STRING | Arma alegadamente portada pela vítima |\r\n| fleeing_status | STRING | Se a vítima estava fugindo (fleeing/not fleeing) |\r\n| disposition | STRING | Resultado/classificação do caso |\r\n| intended_force | STRING | Intenção de uso de força |\r\n| document_link | STRING | Link para documentos relacionados |\r\n| mental_illness_known | STRING | Indicação de doença mental conhecida |\r\n| description | STRING | Descrição detalhada do incidente |\r\n\r\n### Tabela: `locations`\r\n\r\n| Coluna | Tipo | Descrição |\r\n|--------|------|-----------|\r\n| unique_id | INT | Chave estrangeira para vítima (FK) |\r\n| injury_address | STRING | Local exato da lesão |\r\n| death_city | STRING | Cidade onde ocorreu o óbito |\r\n| state | STRING | Estado (abreviação de 2 letras) |\r\n| death_zip | STRING | CEP do local |\r\n| death_county | STRING | Condado |\r\n| full_address | STRING | Endereço completo formatado |\r\n| latitude | FLOAT | Coordenada geográfica |\r\n| longitude | FLOAT | Coordenada geográfica |\r\n\r\n### Tabela: `agencies`\r\n\r\n| Coluna | Tipo | Descrição |\r\n|--------|------|-----------|\r\n| unique_id | INT | Chave estrangeira para vítima (FK) |\r\n| agency_name | STRING | Nome da(s) agência(s) policial(is) envolvida(s) |\r\n\r\n## 🔗 Modelo Relacional\r\n\r\n| Tabela Origem | Relacionamento | Tabela Destino | Cardinalidade |\r\n|--------------|---------------|---------------|--------------|\r\n| victims | 1:1 | incidents | Uma vítima para um incidente |\r\n| victims | 1:1 | locations | Uma vítima para um local |\r\n| victims | 1:N | agencies | Uma vítima pode ter múltiplas agências envolvidas |\r\n\r\n\r\n","user":"anonymous","dateUpdated":"2025-04-16T00:41:40+0000","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Spark Sql Joins e Escrita</h1>\n<blockquote>\n<p><a href=\"https://www.kaggle.com/datasets/kannan1314/innocent-deaths-caused-by-police-all-time/data\">https://www.kaggle.com/datasets/kannan1314/innocent-deaths-caused-by-police-all-time/data</a></p>\n</blockquote>\n<h2>Análise de Dados sobre Mortes Causadas por Polícia nos EUA</h2>\n<h4>Sobre o conjunto de dados</h4>\n<p>Este conjunto de dados documenta mortes de civis causadas por intervenção policial nos Estados Unidos. Os registros abrangem diversos casos com informações detalhadas sobre vítimas, circunstâncias dos incidentes, localizações e agências envolvidas.</p>\n<h4>Entidades:</h4>\n<ol>\n<li><code>victims.csv</code> - Informações sobre as vítimas</li>\n<li><code>incidents.csv</code> - Detalhes dos incidentes</li>\n<li><code>locations.csv</code> - Dados geográficos</li>\n<li><code>agencies.csv</code> - Agências policiais envolvidas</li>\n</ol>\n<h2>Dicionário de Dados</h2>\n<h3>Tabela: <code>victims</code></h3>\n<table>\n<thead>\n<tr><th>Coluna</th><th>Tipo</th><th>Descrição</th></tr>\n</thead>\n<tbody>\n<tr><td>unique_id</td><td>INT</td><td>Identificador único da vítima (PK)</td></tr>\n<tr><td>name</td><td>STRING</td><td>Nome completo da vítima</td></tr>\n<tr><td>age</td><td>INT</td><td>Idade da vítima</td></tr>\n<tr><td>gender</td><td>STRING</td><td>Gênero (Male/Female)</td></tr>\n<tr><td>race</td><td>STRING</td><td>Raça/etnia (African-American, White, Hispanic, etc.)</td></tr>\n<tr><td>image_url</td><td>STRING</td><td>URL com foto da vítima</td></tr>\n</tbody>\n</table>\n<h3>Tabela: <code>incidents</code></h3>\n<table>\n<thead>\n<tr><th>Coluna</th><th>Tipo</th><th>Descrição</th></tr>\n</thead>\n<tbody>\n<tr><td>unique_id</td><td>INT</td><td>Chave estrangeira para vítima (FK)</td></tr>\n<tr><td>incident_date</td><td>STRING</td><td>Data do incidente (MM/DD/YYYY)</td></tr>\n<tr><td>highest_level_of_force</td><td>STRING</td><td>Nível máximo de força utilizado</td></tr>\n<tr><td>alleged_weapon</td><td>STRING</td><td>Arma alegadamente portada pela vítima</td></tr>\n<tr><td>fleeing_status</td><td>STRING</td><td>Se a vítima estava fugindo (fleeing/not fleeing)</td></tr>\n<tr><td>disposition</td><td>STRING</td><td>Resultado/classificação do caso</td></tr>\n<tr><td>intended_force</td><td>STRING</td><td>Intenção de uso de força</td></tr>\n<tr><td>document_link</td><td>STRING</td><td>Link para documentos relacionados</td></tr>\n<tr><td>mental_illness_known</td><td>STRING</td><td>Indicação de doença mental conhecida</td></tr>\n<tr><td>description</td><td>STRING</td><td>Descrição detalhada do incidente</td></tr>\n</tbody>\n</table>\n<h3>Tabela: <code>locations</code></h3>\n<table>\n<thead>\n<tr><th>Coluna</th><th>Tipo</th><th>Descrição</th></tr>\n</thead>\n<tbody>\n<tr><td>unique_id</td><td>INT</td><td>Chave estrangeira para vítima (FK)</td></tr>\n<tr><td>injury_address</td><td>STRING</td><td>Local exato da lesão</td></tr>\n<tr><td>death_city</td><td>STRING</td><td>Cidade onde ocorreu o óbito</td></tr>\n<tr><td>state</td><td>STRING</td><td>Estado (abreviação de 2 letras)</td></tr>\n<tr><td>death_zip</td><td>STRING</td><td>CEP do local</td></tr>\n<tr><td>death_county</td><td>STRING</td><td>Condado</td></tr>\n<tr><td>full_address</td><td>STRING</td><td>Endereço completo formatado</td></tr>\n<tr><td>latitude</td><td>FLOAT</td><td>Coordenada geográfica</td></tr>\n<tr><td>longitude</td><td>FLOAT</td><td>Coordenada geográfica</td></tr>\n</tbody>\n</table>\n<h3>Tabela: <code>agencies</code></h3>\n<table>\n<thead>\n<tr><th>Coluna</th><th>Tipo</th><th>Descrição</th></tr>\n</thead>\n<tbody>\n<tr><td>unique_id</td><td>INT</td><td>Chave estrangeira para vítima (FK)</td></tr>\n<tr><td>agency_name</td><td>STRING</td><td>Nome da(s) agência(s) policial(is) envolvida(s)</td></tr>\n</tbody>\n</table>\n<h2>🔗 Modelo Relacional</h2>\n<table>\n<thead>\n<tr><th>Tabela Origem</th><th>Relacionamento</th><th>Tabela Destino</th><th>Cardinalidade</th></tr>\n</thead>\n<tbody>\n<tr><td>victims</td><td>1:1</td><td>incidents</td><td>Uma vítima para um incidente</td></tr>\n<tr><td>victims</td><td>1:1</td><td>locations</td><td>Uma vítima para um local</td></tr>\n<tr><td>victims</td><td>1:N</td><td>agencies</td><td>Uma vítima pode ter múltiplas agências envolvidas</td></tr>\n</tbody>\n</table>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744742629138_77009451","id":"paragraph_1744742629138_77009451","dateCreated":"2025-04-15T18:43:49+0000","dateStarted":"2025-04-16T00:41:40+0000","dateFinished":"2025-04-16T00:41:40+0000","status":"FINISHED","focus":true},{"title":"Leitura dos Dados","text":"%pyspark\ndf_agencies = spark.read.option(\"header\",\"true\").csv(\"s3a://bucket-teste/sparksql/agencies.csv\")\ndf_incidents = spark.read.option(\"header\",\"true\").csv(\"s3a://bucket-teste/sparksql/incidents.csv\")\ndf_locations = spark.read.option(\"header\",\"true\").csv(\"s3a://bucket-teste/sparksql/locations.csv\")\ndf_victims = spark.read.option(\"header\",\"true\").csv(\"s3a://bucket-teste/sparksql/victims.csv\")","user":"anonymous","dateUpdated":"2025-04-16T00:50:25+0000","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=230"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=230"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=230"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=230"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=230"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=230"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=230"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=230"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=231"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=231"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=231"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=231"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=231"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=231"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=231"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=231"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=232"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=232"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=232"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=232"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=232"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=232"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=232"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=232"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=233"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=233"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=233"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=233"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=233"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=233"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=233"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=233"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744764180905_1660219667","id":"paragraph_1744764180905_1660219667","dateCreated":"2025-04-16T00:43:00+0000","dateStarted":"2025-04-16T00:50:25+0000","dateFinished":"2025-04-16T00:50:31+0000","status":"FINISHED"},{"text":"%pyspark\ndf_agencies.createOrReplaceTempView(\"agencies\")\ndf_incidents.createOrReplaceTempView(\"incidents\")\ndf_locations.createOrReplaceTempView(\"locations\")\ndf_victims.createOrReplaceTempView(\"victims\")","user":"anonymous","dateUpdated":"2025-04-16T00:50:26+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744764259156_1862686718","id":"paragraph_1744764259156_1862686718","dateCreated":"2025-04-16T00:44:19+0000","dateStarted":"2025-04-16T00:50:31+0000","dateFinished":"2025-04-16T00:50:35+0000","status":"FINISHED"},{"text":"%spark.sql\nshow tables","user":"anonymous","dateUpdated":"2025-04-16T00:46:59+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"namespace\ttableName\tisTemporary\n\tagencies\ttrue\n\tincidents\ttrue\n\tlocations\ttrue\n\tsongs\ttrue\n\tvictims\ttrue\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744764406416_1456477105","id":"paragraph_1744764406416_1456477105","dateCreated":"2025-04-16T00:46:46+0000","dateStarted":"2025-04-16T00:46:59+0000","dateFinished":"2025-04-16T00:46:59+0000","status":"FINISHED"},{"title":"Realizando Join","text":"%spark.sql\nSELECT v.*, \n       i.incident_date, \n       i.highest_level_of_force,\n       i.alleged_weapon,\n       i.fleeing_status,\n       i.disposition,\n       i.description\nFROM victims v\nJOIN incidents i ON v.unique_id = i.unique_id\nLIMIT 1","user":"anonymous","dateUpdated":"2025-04-16T00:50:51+0000","progress":100,"config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"unique_id\tname\tage\tgender\trace\timage_url\tincident_date\thighest_level_of_force\talleged_weapon\tfleeing_status\tdisposition\tdescription\n25747\tMark A. Horton\t21\tMale\tAfrican-American/Black\tnull\t1/1/2000\tVehicle\tnull\tnull\tUnreported\tTwo Detroit men killed when their car crashed were among at least eight people who died in New Year's holiday weekend traffic accidents in Michigan, police said. Mark A Horton, 21, and passenger Phillip A. Bluebridge, 19, were killed when their car crashed in their hometown at 1:54 a.m. They were not wearing seat belts. While these deaths were not reported in news media as police pursuit deaths, National Highway Traffic Safety Administration data shows police reported two people dying in a police pursuit at 1:54 a.m. on January 1, 2000, on Davison Freeway. It was the only double fatality crash in Michigan that night.\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=237"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=237"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=237"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=237"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=237"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=237"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=237"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=237"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744764532523_1451194781","id":"paragraph_1744764532523_1451194781","dateCreated":"2025-04-16T00:48:52+0000","dateStarted":"2025-04-16T00:50:51+0000","dateFinished":"2025-04-16T00:50:52+0000","status":"FINISHED"},{"title":"Salvando resultado em um novo dataframe","text":"%pyspark\ndf_result = spark.sql(\"\"\"\nSELECT \n    v.unique_id,\n    v.name,\n    v.age,\n    v.gender,\n    v.race,\n    i.incident_date,\n    i.highest_level_of_force,\n    i.alleged_weapon,\n    i.fleeing_status,\n    l.death_city,\n    l.state,\n    l.death_county,\n    a.agency_name,\n    i.description\nFROM victims v\nJOIN incidents i ON v.unique_id = i.unique_id\nJOIN locations l ON v.unique_id = l.unique_id\nLEFT JOIN agencies a ON v.unique_id = a.unique_id\n\"\"\")","user":"anonymous","dateUpdated":"2025-04-16T00:52:59+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"title":true,"results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744764688775_1375973665","id":"paragraph_1744764688775_1375973665","dateCreated":"2025-04-16T00:51:28+0000","dateStarted":"2025-04-16T00:52:10+0000","dateFinished":"2025-04-16T00:52:14+0000","status":"FINISHED"},{"text":"%pyspark\ndf_result.show(1)\ndf_result.count()","user":"anonymous","dateUpdated":"2025-04-16T00:53:23+0000","progress":0,"config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"fontSize":9,"title":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------+--------------+---+------+--------------------+-------------+----------------------+--------------+--------------+----------+-----+------------+-----------+--------------------+\n|unique_id|          name|age|gender|                race|incident_date|highest_level_of_force|alleged_weapon|fleeing_status|death_city|state|death_county|agency_name|         description|\n+---------+--------------+---+------+--------------------+-------------+----------------------+--------------+--------------+----------+-----+------------+-----------+--------------------+\n|    25747|Mark A. Horton| 21|  Male|African-American/...|     1/1/2000|               Vehicle|          null|          null|   Detroit|   MI|       Wayne|       null|Two Detroit men k...|\n+---------+--------------+---+------+--------------------+-------------+----------------------+--------------+--------------+----------+-----+------------+-----------+--------------------+\nonly showing top 1 row\n\n30860\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=245"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=245"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=245"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=245"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=245"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=245"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=245"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=245"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=249"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=249"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=249"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=249"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=249"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=249"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=249"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=249"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=250"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=250"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=250"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=250"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=250"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=250"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=250"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=250"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744764748917_1904159672","id":"paragraph_1744764748917_1904159672","dateCreated":"2025-04-16T00:52:28+0000","dateStarted":"2025-04-16T00:53:23+0000","dateFinished":"2025-04-16T00:53:27+0000","status":"FINISHED"},{"text":"%pyspark\ndf_result.createOrReplaceTempView(\"resultado\")","user":"anonymous","dateUpdated":"2025-04-16T00:54:12+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744764814051_439760053","id":"paragraph_1744764814051_439760053","dateCreated":"2025-04-16T00:53:34+0000","dateStarted":"2025-04-16T00:54:12+0000","dateFinished":"2025-04-16T00:54:15+0000","status":"FINISHED"},{"text":"%spark.sql\nshow views","user":"anonymous","dateUpdated":"2025-04-16T00:54:24+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"namespace\tviewName\tisTemporary\n\tagencies\ttrue\n\tincidents\ttrue\n\tlocations\ttrue\n\tresultado\ttrue\n\tsongs\ttrue\n\tvictims\ttrue\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744764854288_2147313293","id":"paragraph_1744764854288_2147313293","dateCreated":"2025-04-16T00:54:14+0000","dateStarted":"2025-04-16T00:54:24+0000","dateFinished":"2025-04-16T00:54:24+0000","status":"FINISHED"},{"text":"%spark.sql\nSELECT \n    * \nFROM resultado\nLIMIT 1","user":"anonymous","dateUpdated":"2025-04-16T00:55:02+0000","progress":100,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"unique_id\tname\tage\tgender\trace\tincident_date\thighest_level_of_force\talleged_weapon\tfleeing_status\tdeath_city\tstate\tdeath_county\tagency_name\tdescription\n25747\tMark A. Horton\t21\tMale\tAfrican-American/Black\t1/1/2000\tVehicle\tnull\tnull\tDetroit\tMI\tWayne\tnull\tTwo Detroit men killed when their car crashed were among at least eight people who died in New Year's holiday weekend traffic accidents in Michigan, police said. Mark A Horton, 21, and passenger Phillip A. Bluebridge, 19, were killed when their car crashed in their hometown at 1:54 a.m. They were not wearing seat belts. While these deaths were not reported in news media as police pursuit deaths, National Highway Traffic Safety Administration data shows police reported two people dying in a police pursuit at 1:54 a.m. on January 1, 2000, on Davison Freeway. It was the only double fatality crash in Michigan that night.\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=258"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=258"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=258"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=258"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=258"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=258"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=258"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=258"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744764868120_623908863","id":"paragraph_1744764868120_623908863","dateCreated":"2025-04-16T00:54:28+0000","dateStarted":"2025-04-16T00:55:02+0000","dateFinished":"2025-04-16T00:55:02+0000","status":"FINISHED"},{"title":"Salvando dados no Minio","text":"%pyspark\ndf_result.write.mode(\"overwrite\").format(\"parquet\").save(\"s3a://bucket-teste/parquet/\")","user":"anonymous","dateUpdated":"2025-04-16T00:59:39+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"title":true,"results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=265"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=265"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=265"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=265"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=265"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=265"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=265"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=265"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744764911465_1081620044","id":"paragraph_1744764911465_1081620044","dateCreated":"2025-04-16T00:55:11+0000","dateStarted":"2025-04-16T00:56:42+0000","dateFinished":"2025-04-16T00:56:50+0000","status":"FINISHED"},{"title":"Salvando dados no Postgresql","text":"%pyspark\ndb_url = \"jdbc:postgresql://postgres:5432/postgres\"\nproperties = {\n    \"user\": \"admin\",\n    \"password\": \"senhasegura\",\n    \"driver\": \"org.postgresql.Driver\"\n}\n\n(\n    df_result\n    .write\n    .format(\"jdbc\")\n    .option(\"url\", db_url) \n    .option(\"dbtable\", \"police_deaths\")   \n    .option(\"user\", properties[\"user\"]) \n    .option(\"password\", properties[\"password\"]) \n    .option(\"driver\", properties[\"driver\"]) \n    .mode(\"overwrite\") \n    .save()\n)","user":"anonymous","dateUpdated":"2025-04-16T01:01:00+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"title":true,"results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=269"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=269"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=269"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=269"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=269"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=269"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=269"},{"jobUrl":"http://9382a0befda4:4040/jobs/job?id=269"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744765013560_1864515067","id":"paragraph_1744765013560_1864515067","dateCreated":"2025-04-16T00:56:53+0000","dateStarted":"2025-04-16T01:01:00+0000","dateFinished":"2025-04-16T01:01:06+0000","status":"FINISHED"},{"text":"%pyspark\ndf_result.printSchema()","user":"anonymous","dateUpdated":"2025-04-16T01:01:46+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- unique_id: string (nullable = true)\n |-- name: string (nullable = true)\n |-- age: string (nullable = true)\n |-- gender: string (nullable = true)\n |-- race: string (nullable = true)\n |-- incident_date: string (nullable = true)\n |-- highest_level_of_force: string (nullable = true)\n |-- alleged_weapon: string (nullable = true)\n |-- fleeing_status: string (nullable = true)\n |-- death_city: string (nullable = true)\n |-- state: string (nullable = true)\n |-- death_county: string (nullable = true)\n |-- agency_name: string (nullable = true)\n |-- description: string (nullable = true)\n\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744765300930_271742270","id":"paragraph_1744765300930_271742270","dateCreated":"2025-04-16T01:01:40+0000","dateStarted":"2025-04-16T01:01:46+0000","dateFinished":"2025-04-16T01:01:50+0000","status":"FINISHED"},{"text":"%pyspark\ndf_victims = spark.read.csv(\"\")\nincidents\nlocations\nagencies","user":"anonymous","dateUpdated":"2025-04-16T00:43:00+0000","progress":0,"config":{"lineNumbers":true,"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"fontSize":9,"editorHide":true,"title":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744764100144_172892819","id":"paragraph_1744764100144_172892819","dateCreated":"2025-04-16T00:41:40+0000","status":"READY"}],"name":"08 - Spark SQL Joins e Escrita","id":"2KTMWAUNW","defaultInterpreterGroup":"spark","version":"0.12.0","noteParams":{},"noteForms":{},"angularObjects":{},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{},"path":"/08 - Spark SQL Joins e Escrita"}