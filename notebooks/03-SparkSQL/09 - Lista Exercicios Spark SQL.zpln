{"paragraphs":[{"text":"%md\r\n# 📝 Lista de Exercícios - SparkSQL com os DataFrames Innocent Deaths caused by Police (All time)\r\n\r\n\r\nhttps://www.kaggle.com/datasets/kannan1314/innocent-deaths-caused-by-police-all-time/\r\n\r\nNeste exercício, você vai praticar operações básicas e intermediárias no PySpark usando um DataFrame que une dados de mortes de individuos após encontros com policiais nos EUA, os dados são disponibilizadpos pela https://fatalencounters.org/ \r\n\r\n---\r\n\r\n#### 📁 1. Leitura dos dados do MinIO\r\nLeia os arquivos CSV usando Spark e crie DataFrames.\r\n","user":"anonymous","dateUpdated":"2025-04-16T17:34:32+0000","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>📝 Lista de Exercícios - SparkSQL com os DataFrames Innocent Deaths caused by Police (All time)</h1>\n<p><a href=\"https://www.kaggle.com/datasets/kannan1314/innocent-deaths-caused-by-police-all-time/\">https://www.kaggle.com/datasets/kannan1314/innocent-deaths-caused-by-police-all-time/</a></p>\n<p>Neste exercício, você vai praticar operações básicas e intermediárias no PySpark usando um DataFrame que une dados de mortes de individuos após encontros com policiais nos EUA, os dados são disponibilizadpos pela <a href=\"https://fatalencounters.org/\">https://fatalencounters.org/</a></p>\n<hr />\n<h4>📁 1. Leitura dos dados do MinIO</h4>\n<p>Leia os arquivos CSV usando Spark e crie DataFrames.</p>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744823081768_576419329","id":"paragraph_1744823081768_576419329","dateCreated":"2025-04-16T17:04:41+0000","dateStarted":"2025-04-16T17:34:32+0000","dateFinished":"2025-04-16T17:34:32+0000","status":"FINISHED","focus":true},{"text":"%md\n### 🗃️ 2. Criação das tabelas temporárias para consultas SQL\nCrie views temporárias com os DataFrames lidos.","user":"anonymous","dateUpdated":"2025-04-16T17:36:52+0000","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>🗃️ 2. Criação das tabelas temporárias para consultas SQL</h3>\n<p>Crie views temporárias com os DataFrames lidos.</p>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744823910026_1386567614","id":"paragraph_1744823910026_1386567614","dateCreated":"2025-04-16T17:18:30+0000","dateStarted":"2025-04-16T17:36:52+0000","dateFinished":"2025-04-16T17:36:52+0000","status":"FINISHED"},{"text":"%md\n### 🔍 3. Quantas vítimas têm em cada gênero? 👩‍🦰👨‍🦱","user":"anonymous","dateUpdated":"2025-04-16T17:36:42+0000","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>🔍 3. Quantas vítimas têm em cada gênero? 👩‍🦰👨‍🦱</h3>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744824262776_2030657270","id":"paragraph_1744824262776_2030657270","dateCreated":"2025-04-16T17:24:22+0000","dateStarted":"2025-04-16T17:36:42+0000","dateFinished":"2025-04-16T17:36:42+0000","status":"FINISHED"},{"text":"%md\n### 📈 4. Qual o ano com mais incidentes registrados? ","user":"anonymous","dateUpdated":"2025-04-16T17:36:38+0000","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>📈 4. Qual o ano com mais incidentes registrados?</h3>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744824468078_858878104","id":"paragraph_1744824468078_858878104","dateCreated":"2025-04-16T17:27:48+0000","dateStarted":"2025-04-16T17:36:38+0000","dateFinished":"2025-04-16T17:36:38+0000","status":"FINISHED"},{"text":"%md\n### 🧠 5. Quantas vítimas tinham algum caso mental conhecido?","user":"anonymous","dateUpdated":"2025-04-16T17:36:33+0000","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>🧠 5. Quantas vítimas tinham algum caso mental conhecido?</h3>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744824595436_1287737097","id":"paragraph_1744824595436_1287737097","dateCreated":"2025-04-16T17:29:55+0000","dateStarted":"2025-04-16T17:36:33+0000","dateFinished":"2025-04-16T17:36:33+0000","status":"FINISHED"},{"text":"%md\n### 🌍 6. Liste as 5 cidades com maior número de incidentes","user":"anonymous","dateUpdated":"2025-04-16T17:37:17+0000","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>🌍 6. Liste as 5 cidades com maior número de incidentes</h3>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744824993911_1939793442","id":"paragraph_1744824993911_1939793442","dateCreated":"2025-04-16T17:36:33+0000","dateStarted":"2025-04-16T17:37:17+0000","dateFinished":"2025-04-16T17:37:18+0000","status":"FINISHED"},{"text":"%md\n### 🔗 7. Nome e cidade de vítimas que sofreram incidentes com força letal ☠️\n🎯 Objetivo: Usar JOIN entre victims, incidents e locations para listar o nome da vítima, idade e cidade onde o incidente com uso intencional de força letal ocorreu.","user":"anonymous","dateUpdated":"2025-04-16T17:38:41+0000","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>🔗 7. Nome e cidade de vítimas que sofreram incidentes com força letal ☠️</h3>\n<p>🎯 Objetivo: Usar JOIN entre victims, incidents e locations para listar o nome da vítima, idade e cidade onde o incidente com uso intencional de força letal ocorreu.</p>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744825032413_1732959195","id":"paragraph_1744825032413_1732959195","dateCreated":"2025-04-16T17:37:12+0000","dateStarted":"2025-04-16T17:38:41+0000","dateFinished":"2025-04-16T17:38:41+0000","status":"FINISHED"},{"text":"%md\n📌 8. Gere um relatorio em CSV e salve no Minio na pasta \"Relatório Geral de Incidentes\"\nQue deve mostrar: Uma visão completa unindo todas as tabelas — dados da vítima, data e tipo do incidente, localização e agência envolvida.\n\n📄 Colunas sugeridas:\nname, \ngender, \nrace\nincident_date, \nhighest_level_of_force, \nintended_force, \nfleeing_status, \nmental_illness_known\ndeath_city, \nstate, \nagency_name\n\n🎂 Crie uma coluna com a faixas etária:\n-- 0-18 👶\n-- 19-25 🧑‍🎓\n-- 26-35 🧑‍💼\n-- 36-50 🧑‍🔧\n-- 50+ 👵","user":"anonymous","dateUpdated":"2025-04-16T17:50:38+0000","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>📌 8. Gere um relatorio em CSV e salve no Minio na pasta &ldquo;Relatório Geral de Incidentes&rdquo;<br />\nQue deve mostrar: Uma visão completa unindo todas as tabelas — dados da vítima, data e tipo do incidente, localização e agência envolvida.</p>\n<p>📄 Colunas sugeridas:<br />\nname,<br />\ngender,<br />\nrace<br />\nincident_date,<br />\nhighest_level_of_force,<br />\nintended_force,<br />\nfleeing_status,<br />\nmental_illness_known<br />\ndeath_city,<br />\nstate,<br />\nagency_name</p>\n<p>🎂 Crie uma coluna com a faixas etária:<br />\n&ndash; 0-18 👶<br />\n&ndash; 19-25 🧑‍🎓<br />\n&ndash; 26-35 🧑‍💼<br />\n&ndash; 36-50 🧑‍🔧<br />\n&ndash; 50+ 👵</p>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744825121573_1416151901","id":"paragraph_1744825121573_1416151901","dateCreated":"2025-04-16T17:38:41+0000","dateStarted":"2025-04-16T17:50:38+0000","dateFinished":"2025-04-16T17:50:38+0000","status":"FINISHED"},{"text":"%md\n","user":"anonymous","dateUpdated":"2025-04-16T17:49:33+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false}},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744825773679_84881936","id":"paragraph_1744825773679_84881936","dateCreated":"2025-04-16T17:49:33+0000","status":"READY"}],"name":"09 - Lista Exercicios Spark SQL","id":"2KRCZ3924","defaultInterpreterGroup":"spark","version":"0.12.0","noteParams":{},"noteForms":{},"angularObjects":{},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{},"path":"/09 - Lista Exercicios Spark SQL"}